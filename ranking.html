<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>ğŸ† Ranking zwyciÄ™zcÃ³w</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {
  font-family: Arial, sans-serif;
  background:#111;
  color:#fff;
  padding:20px;
}
table {
  width:100%;
  max-width:600px;
  margin:auto;
  border-collapse:collapse;
}
th,td {
  border:1px solid #444;
  padding:12px;
  text-align:center;
}
th { background:#222; }
h1 { text-align:center; margin-bottom:20px; }

/* Styl dla przycisku czyszczenia */
.clear-btn {
  display: block;
  margin: 0 auto 20px auto;
  padding: 10px 20px;
  background-color: #e74c3c;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-weight: bold;
}
.clear-btn:hover {
  background-color: #c0392b;
}
</style>
</head>
<body>

<h1>ğŸ† Ranking zwyciÄ™zcÃ³w</h1>

<button class="clear-btn" onclick="clearRanking()">ğŸ—‘ï¸ WyczyÅ›Ä‡ caÅ‚y ranking</button>

<table id="rank">
<tr><th>#</th><th>ImiÄ™</th><th>Wygrane</th></tr>
</table>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { 
  getFirestore, collection, onSnapshot, getDocs, deleteDoc, doc 
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCEEVCSx2uOOggu_4y_gUo4WMyKqf-HlKI",
  authDomain: "obstaiwanie.firebaseapp.com",
  projectId: "obstaiwanie"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const table = document.getElementById("rank");

// Pobieranie rankingu w czasie rzeczywistym
onSnapshot(collection(db,"ranking"), snap=>{
  const data=[];
  snap.forEach(d=>data.push({name:d.id, ...d.data()}));
  data.sort((a,b)=>b.wins-a.wins);

  table.innerHTML="<tr><th>#</th><th>ImiÄ™</th><th>Wygrane</th></tr>";
  data.forEach((u,i)=>{
    table.innerHTML+=`
      <tr>
        <td>${i+1}</td>
        <td>${u.name}</td>
        <td>${u.wins}</td>
      </tr>`;
  });
});

// FUNKCJA CZYSZCZENIA RANKINGU
window.clearRanking = async () => {
  if (confirm("Czy na pewno chcesz trwale usunÄ…Ä‡ WSZYSTKIE rekordy z rankingu?")) {
    try {
      // Pobierz wszystkie dokumenty z kolekcji "ranking"
      const querySnapshot = await getDocs(collection(db, "ranking"));
      
      // UsuÅ„ kaÅ¼dy dokument po kolei
      const deletePromises = [];
      querySnapshot.forEach((document) => {
        deletePromises.push(deleteDoc(doc(db, "ranking", document.id)));
      });

      await Promise.all(deletePromises);
      alert("Ranking zostaÅ‚ wyczyszczony.");
    } catch (error) {
      console.error("BÅ‚Ä…d podczas usuwania:", error);
      alert("Nie udaÅ‚o siÄ™ wyczyÅ›ciÄ‡ rankingu.");
    }
  }
};
</script>

</body>
</html>
