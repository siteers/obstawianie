<!DOCTYPE html>
<html>
<head>
  
  <meta charset="UTF-8">
  <title>Lista użytkowników</title>
</head>
<body>
<h2>Lista zapisanych osób</h2>

<button onclick="clearAll()">Wyczyść rekordy</button>
<br><br>

<table border="1" id="table">
  <tr>
    <th>Imię</th>
    <th>Godzina</th>
  </tr>
</table>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCEEVCSx2uOOggu_4y_gUo4WMyKqf-HlKI",
  authDomain: "obstaiwanie.firebaseapp.com",
  projectId: "obstaiwanie",
  storageBucket: "obstaiwanie.firebasestorage.app",
  messagingSenderId: "64783465818",
  appId: "1:64783465818:web:0a9aa45acf40e351ae8763"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const table = document.getElementById("table");

// Wczytaj dane
async function loadData() {
  const querySnapshot = await getDocs(collection(db, "users"));

  querySnapshot.forEach((docu) => {
    const data = docu.data();
    const row = `
      <tr>
        <td>${data.name}</td>
        <td>${data.hour}</td>
      </tr>
    `;
    table.innerHTML += row;
  });
}

loadData();

// Wyczyść wszystkie rekordy
window.clearAll = async function(){
  const querySnapshot = await getDocs(collection(db, "users"));
  querySnapshot.forEach(async (d) => {
    await deleteDoc(doc(db, "users", d.id));
  });

  table.innerHTML = `
    <tr>
      <th>Imię</th>
      <th>Godzina</th>
    </tr>`;
}
</script>

</body>
</html>




